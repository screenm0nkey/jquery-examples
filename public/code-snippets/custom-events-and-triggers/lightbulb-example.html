<!DOCTYPE HTML><html lang="en-US">    <head>        <meta charset="UTF-8">        <title></title>        <style type="text/css">            .clone {                display: none;            }                        div {                border: 1px solid;            }                        .room {                clear: both;                border: none;                border: solid #ccc;                margin-bottom: 20px;                overflow: auto;            }                        .switch, .lightbulb, .clapper, #master_switch, .buttons {                position: relative;                height: 50px;                width: 50px;                float: left;                cursor: pointer;                margin-left: 20px;            }                        .buttons {                border: none;            }                        .switch {                background-color: white;            }                        .lightbulb, .lightbulb.off {                background-color: black;                margin-right: 50px;                margin-left: 0px;            }                        .lightbulb.on {                background-color: yellow;            }                        .clapper {                background-color: #ccc;            }                        #master_switch {                background-color: red;            }        </style>        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>        <script type="text/javascript">            $(function(){                //light switch and clapper behaviour                $('#house').delegate('.switch, .clapper', 'click', function(){                    $(this).parent().find('.lightbulb').trigger('changeState');                });                                                //add light switch and clapper                $('#house').delegate('div.buttons > input[type=button]', 'click', function(){                    $(this).closest('.room').find('.' + $(this).attr('rel') + ':first').clone().insertBefore($(this).closest('div'));                    return false;                });                                                //lightbulb behavoirs                $('#house').delegate('.lightbulb', 'changeState', function(e){                    var $light = $(this);                    if ($light.hasClass('on')) {                        $light.removeClass('on').addClass('off');                    }                    else {                        $light.removeClass('off').addClass('on');                    }                }).delegate('.lightbulb', 'turnOn', function(e){                    $(this).removeClass('off').addClass('on');                }).delegate('.lightbulb', 'turnOff', function(e){                    $(this).removeClass('on').addClass('off');                });                                                //add another room                $('input[rel=addroom]').click(function(){                    console.log($('.room.clone').clone().removeClass('clone').insertAfter($('.room:last')))                    //$('.room:last').clone().insertAfter($('.room:last'));                    return false;                });                                //master switch - turn all lights off/on                $('#master_switch').click(function(){                    if ($('.lightbulb').hasClass('on')) {                        $('.lightbulb').trigger('turnOff');                    }                    else {                        $('.lightbulb').trigger('turnOn');                    }                });            });        </script>    </head>    <body>        <div class="room clone" rel="">            <div class="lightbulb">Bulb</div>            <div class="switch">Switch</div>            <div class="switch">Switch</div>            <div class="clapper">Clapper</div>            <div class="buttons">                <input type="button" value="Add Switch" rel="switch">                <input type="button" value="Add Clapper" rel="clapper"></div>        </div>		        <div id="house">            <div class="room" rel="kitchen">                <div class="lightbulb">Bulb</div>                <div class="switch">Switch</div>                <div class="switch">Switch</div>                <div class="clapper">Clapper</div>                <div class="buttons">                    <input type="button" value="Add Switch" rel="switch">                    <input type="button" value="Add Clapper" rel="clapper"></div>            </div>            <div class="room" rel="bedroom">                <div class="lightbulb">Bulb</div>                <div class="switch">Switch</div>                <div class="switch">Switch</div>                <div class="clapper">Clapper</div>                <div class="buttons">                    <input type="button" value="Add Switch" rel="switch">                    <input type="button" value="Add Clapper" rel="clapper"></div>            </div>            <div id="master_switch">Master</div>            <input type="button" value="Add Room" rel="addroom"></div>    </body></html>