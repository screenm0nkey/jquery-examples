<!DOCTYPE HTML><html lang="en-US">    <head>        <meta charset="UTF-8">        <title>A basic implemenation of $.with</title>        <script type="text/javascript">            log = console.log;            dir = console.dir;        </script>        <script type="text/javascript" src="http://libraries/jquery-1.5.1.js"></script>        <script type="text/javascript">            $(function(){                // the promise object offers a reduced api of the deferred object so you can still bind directly to the deferred object				// as is happening with the logging of 'STEVE'                var promise = (function showDiv2(){                    return $.Deferred(function(dfd){                        $('#foo2').fadeIn(1000, dfd.resolve);                    }).done(function(){                        log('STEVE');                    }).promise();                })();                   				// All when is doing here is taking other deferred objects as arguments, checking its Resolved status and then updating it's own deferred object				// which is uses to allow callbacks to itself.                $.when = function(promise){                    return $.Deferred(function(dfd){                        (function namedFunc(){                            setTimeout(function(){                                if (!promise.isResolved()) {                                    log('promise.isResolved() ', promise.isResolved());                                    namedFunc();                                }                                else {                                    log('DIANNE');									dfd.resolve({success:true});                                }                            }, 300);                        })();                    }).promise();                };                				                $.when(promise).done(function(args){                    log('KAREN', args);                });                                                                                                                            });        </script>    </head>    <body>        <div id="foo" style="background:red;height:100px; width:100px;display:none;">Foo</div>        <div id="foo2" style="background:red;height:100px; width:100px;display:none;">Foo 2</div>    </body></html>